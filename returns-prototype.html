---
layout: page
title: Returns-prototype
permalink: /returns-prototype/
---

<style>
  .returned-item--1::after { background-image: url({{'/assets/images/item_1.png' | prepend: site.baseurl }}); }
  .returned-item--2::after { background-image: url({{'/assets/images/item_2.png' | prepend: site.baseurl }}); }
  .returned-item--3::after { background-image: url({{'/assets/images/item_3.png' | prepend: site.baseurl }}); }
  .returned-item--4::after { background-image: url({{'/assets/images/item_4.png' | prepend: site.baseurl }}); }
  .returned-item--5::after { background-image: url({{'/assets/images/item_5.png' | prepend: site.baseurl }}); }
</style>

<ul class="returned-items-list">
  <li class="returned-item"
    data-item-status   = "out"
    data-item-type     = "purses"
    data-item-override = ""
    data-item-location = ""
    date-item-id       = 1234567>
    <img src="{{site.baseurl}}/assets/images/item_1.png">
  </li>
  <li class="returned-item"
    data-item-status   = "sold"
    data-item-override = ""
    data-item-type     = "lg / xl"
    data-item-location = ""
    date-item-id       = 1234567>
    <img src="{{site.baseurl}}/assets/images/item_2.png">
  </li>
  <li class="returned-item"
    data-item-status   = "out"
    data-item-type     = "md"
    data-item-override = ""
    data-item-location = ""
    date-item-id       = 1234567>
    <img src="{{site.baseurl}}/assets/images/item_3.png">
  </li>
  <li class="returned-item"
    data-item-status   = "out"
    data-item-type     = "md"
    data-item-override = "rtv"
    data-item-location = ""
    date-item-id       = 1234567>
    <img src="{{site.baseurl}}/assets/images/item_4.png">
  </li>
  <li class="returned-item"
    data-item-status   = "sold"
    data-item-type     = "xs"
    data-item-override = ""
    data-item-location = ""
    date-item-id       = 1234567>
    <img src="{{site.baseurl}}/assets/images/item_5.png">
  </li>
</ul>
<footer class="return-info bounceInUp animated"></footer>

<div class="returns-banner"></div>



<button class="btn btn-xs btn-primary pos-abs pos-b pos-r z10 js-randomize">Randomize</button>

<script type="text/javascript">
  $(function(){

    setup();

    $(".returned-item").click(function(){
      this_status = $(this).data("item-status");
      if(this_status == "out" || this_status == "sold"){
        $(this).data("item-status", "in");
        item_status();
      }
      else {
        item_status();
      }

      $(".returned-item").removeClass("returned-item--origin").removeClass("returned-item--current");
      $(this).addClass("returned-item--current returned-item--done");
      $(".returned-item--current").removeClass("returned-item--sold returned-item--lg returned-item--md returned-item--sm returned-item--xs returned-item--dmg returned-item--jewelry returned-item--clr returned-item--acc returned-item--rtv").addClass("returned-item--"+$(".returned-item--current").data("item-location"));

      rearrange($(this));
      write_location($(this), $(this).data("item-type"));
      color_banner();
    });

    $('body').bind('keyup', function(e) {
    	if(e.keyCode==49){
    		$(".returned-item:nth-child(1)").click();
    	}
    	else if(e.keyCode==50){
    		$(".returned-item:nth-child(2)").click();
    	}
    	else if(e.keyCode==51){
    		$(".returned-item:nth-child(3)").click();
    	}
    	else if(e.keyCode==52){
    		$(".returned-item:nth-child(4)").click();
    	}
    	else if(e.keyCode==53){
    		$(".returned-item:nth-child(5)").click();
    	}
    	else if(e.keyCode==55){
        set_dmg($(".returned-item--current"));
    	}
    	else if(e.keyCode==56){
        sold($(".returned-item--current"));
    	}
    	else if(e.keyCode==57){
        set_in($(".returned-item--current"));
    	}
    });

    $(".js-randomize").click(function(){
      status_array   = ["out", "sold"];
      type_array     = ["lg / xl", "md", "sm", "xs", "jewelry"];
      override_array = ["","","rtv", "clr"];

      $.each([ 1,2,3,4,5 ], function( index, value ) {
        num1 = Math.floor(Math.random()*status_array.length);
        num2 = Math.floor(Math.random()*type_array.length);
        num3 = Math.floor(Math.random()*override_array.length);
        status   =   status_array[num1];
        type     =     type_array[num2];
        override = override_array[num3];

        $(".returned-item--"+index).data("item-status", status).data("item-type", type).data("item-override", override).data("location","");
      });

      setup();
    });

  });

  function setup() {
    set_location();
    item_status();

    if ($(".returned-item--current").length == 0) {
      $(".returned-item").addClass("returned-item--origin");
    }

    $(".returned-item--current").removeClass("returned-item--current");

    $(".returned-item--done").removeClass("returned-item--done");
    $('[data-item-status="sold"]').addClass("returned-item--done");

    done_items = $(".returned-item--done");
    $(".returned-items-list").append(done_items, $(".returned-item:not('.returned-item--done')"));
  }

  function set_dmg(e) {
    if (e.data("item-override") == "rtv" || e.data("item-override") == "clr") {
    }
    else if (e.data("item-override") == "dmg"){
    }
    else {
      e.data("item-override", "dmg");
      override = e.data("item-override");
      e.data("item-location", override);
      color_banner();
    }
    e.data("item-status", "in");
    write_location(e, e.data("item-type"));
    item_status();
  }

  function sold(e) {
    e.data("item-status", "sold");
    e.data("item-location", "sold");
    write_location(e, e.data("item-type"));
    item_status();
    color_banner();
  }

  function set_in(e) {
    if (e.data("item-override") == "rtv" || e.data("item-override") == "clr") {
      e.data("item-status", "in");
      set_location();
      write_location(e, e.data("item-type"));
      item_status();
      color_banner();
    }
    else {
      e.data("item-override", "");
      e.data("item-status", "in");
      set_location();
      write_location(e, e.data("item-type"));
      item_status();
      color_banner();
    }

  }

  function rearrange(e) {
    done_items = $(".returned-item--done");
    $(".returned-items-list").append(done_items, e, $(".returned-item:not('.returned-item--done')"));
  }

  function item_status() {
    $(".returned-item").each( function () {
      status = $(this).data("item-status");
      indicator = $(this).find(".returned-item__status");
      if (status == "sold") {
        indicator.removeClass("returned-item__status--undisclosed");
        indicator.find("span").text("$");
      }
      else if (status == "" || status == "out") {
        indicator.addClass("returned-item__status--undisclosed");
      }
      else if (status != "out") {
        indicator.removeClass("returned-item__status--undisclosed");
        indicator.find("span").text("âˆš");
      }
    });
  }

  function set_location() {
    $(".returned-item").each( function () {
      status   = $(this).data("item-status");
      override = $(this).data("item-override");
      type     = $(this).data("item-type");

      if (override == "rtv" || override == "clr") {
        $(this).data("item-location", override);
      }
      else if (override == "dmg") {
        $(this).data("item-location", override);
      }
      else {
        $(this).data("item-location", type);
      }

      write_location($(this), type);
    });
  }

  function write_location(e, t) {
    loc    = e.data("item-location");
    width  = $(".returned-item--current").width();
    offset = $(".returned-item--current").offset();
    target = $(".return-info");
    if (offset != null) {
      target.width(width).offset({ left: offset.left });
    }
    if (loc == "purses"){
      target.addClass("return-info--double-lined").html("purses<br><span>& scarves</span>")
    }
    else if (loc == "bracelets"){
      target.addClass("return-info--double-lined").html("bracelets<br><span>& earrings</span>")
    }
    else {
      target.removeClass("return-info--double-lined").html(loc);
    }
    // Some silly js horseshit that reruns a CSS animation. God.
    target.removeClass('bounceInUp');
    setTimeout(
        function(){target.addClass('bounceInUp')}
        , 1);

    $(".returned-item--current").removeClass("returned-item--sold returned-item--lg returned-item--md returned-item--sm returned-item--xs returned-item--dmg returned-item--jewelry returned-item--clr returned-item--acc returned-item--rtv").addClass("returned-item--"+e.data("item-location"));
  }

  function color_banner() {
    current_location = $(".returned-item--current").data("item-location");
    $(".returns-banner").removeClass().addClass("returns-banner");
    $("body").removeClass().addClass(current_location);

    setTimeout(function(){
      $(".returns-banner").addClass("returns-banner--"+current_location+" current");
    }, 300);
  }

  function slideSwap($set1, $set2) {

    //$elem.append(infoString($elem));
    //$after.append(infoString($after));
    $set1.css("color", "red");
    $set2.css("color", "blue");
    var $set3 = $set2.last().nextAll();
    $set3.css("color", "green");

    var mb_prev = cssprop($set1.first().prev(), "margin-bottom");
    if (isNaN(mb_prev)) mb_prev = 0;
    var mt_next = cssprop($set2.last().next(), "margin-top");
    if (isNaN(mt_next)) mt_next = 0;

    var mt_1 = cssprop($set1.first(), "margin-top");
    var mb_1 = cssprop($set1.last(), "margin-bottom");
    var mt_2 = cssprop($set2.first(), "margin-top");
    var mb_2 = cssprop($set2.last(), "margin-bottom");

    var h1 = $set1.last().offset().top + $set1.last().outerHeight() - $set1.first().offset().top;
    var h2 = $set2.last().offset().top + $set2.last().outerHeight() - $set2.first().offset().top;

    move1 = h2 + Math.max(mb_2, mt_1) + Math.max(mb_prev, mt_2) - Math.max(mb_prev, mt_1);
    move2 = -h1 - Math.max(mb_1, mt_2) - Math.max(mb_prev, mt_1) + Math.max(mb_prev, mt_2);
    move3 = move1 + $set1.first().offset().top + h1 - $set2.first().offset().top - h2 +
        Math.max(mb_1,mt_next) - Math.max(mb_2,mt_next);

    // let's move stuff
    $set1.css('position', 'relative');
    $set2.css('position', 'relative');
    $set3.css('position', 'relative');
    $set1.animate({'top': move1}, {duration: 1000});
    $set3.animate({'top': move3}, {duration: 500});
    $set2.animate({'top': move2}, {duration: 1000, complete: function() {
        // rearrange the DOM and restore positioning when we're done moving
        $set1.insertAfter($set2.last())
        $set1.css({'position': 'static', 'top': 0});
        $set2.css({'position': 'static', 'top': 0});
        $set3.css({'position': 'static', 'top': 0});
      }
    });

  }








</script>
